---
title: Contributing Positively
date: 2023-12-27T16:13:07.000Z
draft: false
tags:
  - onward and upward
  - society
  - positivity
  - love
  - pollution
  - philosophy
---

What if the most revolutionary act in today's world is simply being a good neighbor? In a time when roughly 75% of Americans with a high school education or less report that they seldom or never attend local community events or meetings[^2], the simple act of positive contribution might be our most powerful untapped resource.

We live in a society, or so they say. And as members of society—a community of
interdependent people—we should probably strive to contribute positively.
Society (and community) can provide tremendous value when it works well, from public
infrastructure to cultural events to mutual support in times of crisis.

> The true measure of any society can be found in how it treats its most vulnerable members.

&mdash; <cite>Mahatma Gandhi</cite>

## The Impact of Negative Contributions

It's easy to contribute negatively, or rather, to detract. Simple examples of
detracting from society might be:

- Excessive consumption of resources
- Excessive pollution and environmental harm
- Causing harm to others through actions or words
- Taking without contributing back

History provides us with stark examples of how negative contributions can devastate entire societies. The Dust Bowl of the 1930s stands as a powerful case study. During the early 20th century, farmers across the American Plains engaged in aggressive farming techniques that prioritized short-term gain over sustainability. They plowed under the native grasses that had evolved over millennia to hold the soil in place during droughts and high winds.

When severe drought hit in the 1930s, the exposed topsoil turned to dust and was carried away by winds in enormous "black blizzards" that could block out the sun for days. These dust storms destroyed crops, killed livestock, caused widespread respiratory illness, and forced hundreds of thousands of people to abandon their homes and livelihoods.

What makes this story particularly relevant is that it wasn't caused by any single person acting maliciously. Rather, it was the collective impact of many individuals making choices that seemed rational from their individual perspectives but proved catastrophic when multiplied across society. The Dust Bowl demonstrates how our individual actions—even when seemingly small or motivated by necessity—can combine to create devastation that harms everyone, including ourselves.

The eventual recovery came through collective positive action: government soil conservation programs, sustainable farming practices, and community cooperation—showing that just as negative contributions can destroy, positive ones can rebuild.

## Modern Examples of Positive Contribution

For a contemporary example of positive collective impact, we need look no further than the open-source software movement. What began as a radical idea—that software could be freely shared, modified, and distributed—has transformed into one of the most powerful examples of collaborative contribution in human history.

Linux, the open-source operating system developed through the voluntary contributions of thousands of programmers worldwide, now runs 96.3% of the world's top one million web servers[^3]. The collective value created by these contributions is staggering—a 2015 Linux Foundation report estimated the value of its collaborative projects at over $5 billion[^4]. On a broader scale, the aggregate economic value of all open source software globally has been estimated at $8.8 trillion on the demand side (the estimated cost to replicate the functionality)[^8].

Even more remarkable is how Linux quietly powers the majority of smartphones worldwide through Android's operating system. Android, which runs on the Linux kernel, powers approximately 71% of all mobile devices globally[^6]. With over 3 billion active Android devices, the economic value generated by this free, open-source technology is immense; Google's platforms (including Android, Play, etc.) contributed $739 billion to US economic activity in 2023, while the global mobile app economy reached half a trillion dollars[^7].

This widespread adoption represents perhaps the largest-scale example of how individual positive contributions, when aggregated, can create systems that benefit everyone and counterbalance the profit-driven models that often lead to societal detractions. What began as a passion project by a Finnish computer science student has transformed into the technological backbone of modern communication and commerce.

## Measuring Society's Value

Society is more than the sum of its parts, but measuring its value is difficult. What
constitutes society is difficult to define, and the value of community is not
something we can easily assign a number to, particularly in an economic system
that doesn't account for happiness or well-being.

Consider this example: When a neighbour helps you out without expecting anything in return, we can't
necessarily measure the value of their help in terms of gross domestic product.
If your neighbour saved you from having to hire someone to solve a problem, then
the net effect on GDP would be neutral as no financial transaction occurred
(which means there's no value to measure). Even a child could tell you that
having a good neighbour is a positive thing in your life, however, our economic
models place no value on being a good neighbour. Research actually shows that strong social connections can increase longevity by up to 50%[^1].

> The best way to find yourself is to lose yourself in the service of others.

&mdash; <cite>Mahatma Gandhi</cite>

## Wisdom from Religious Traditions

Getting back to the topic of this post: it's not difficult to contribute
positively to society, and I generally try to live my life in such a way that
I'm (at the very least) not detracting. Christianity (and other religions)
provide some good ideas on how to contribute positively, as with avoiding the
seven deadly sins which are detractors:

1. Pride
2. Gluttony
3. Lust
4. Greed
5. Envy
6. Wrath
7. Laziness (sloth)

Most of these are instructive warnings about human nature, although one stands out from the rest: **lust** is hardly
sinful and mostly harmless (provided there's no abuse involved). Love and lust
are natural healthy parts of the human experience and one of the few things you
can do without having to spend money or get permission from any third parties or
government agencies (at least in places where you're free to love who you
please). Christianity has a long history of shaming people for celebrating their
bodies and loving who they want, so we can set this one aside and focus on the
others.

## Greed: the Most Damaging Detractor

Of all the traditional vices, greed stands out as particularly harmful to our collective well-being. If I had to pick one sin as the most damaging to society, I would choose **greed**. I
think the majority of modern societal problems today can be traced back to
greed. From corporate malfeasance to political corruption to environmental degradation, unchecked greed sits at the core of many systemic issues. Everyone's trying to screw everyone else (and I don't mean in a good way)
to get rich quickly, and it generally makes everything worse for everyone - what tech critic Cory Doctorow aptly calls "the enshittification of everything"[^5].

## The Golden Rule: a Universal Principle

We should also discuss the so-called "Golden Rule," which is best described as
not treating others in ways you don't wish to be treated. To put it in more
contemporary parlance: don't be an asshole. This principle appears across virtually every major philosophical and religious tradition, from Confucianism to Kant's categorical imperative. This is the easiest way to
contribute positively to society, but it's something many people struggle with
at various points in their lives.

## A Personal Reflection

I've witnessed the power of positive contribution firsthand many times. Strangers have helped me out of a jam on countless occasions, such as the times when I was cycling cross-country and people would share food, water, and shelter with me. People driving past would pull over to ask if I was okay, and even though I was fine, they insisted on helping me out. This is one of the most positive memories I have from my randonneuring days.

On one particular occasion, a man saved my life when I collapsed on the side of the road from heat stroke. He happened to have a large jug of water in the back of his truck, and he poured it on top of me to help me cool off. At the time, I was unable to stand, and the temperature that day was over 40C in the middle of central valley of California. I was able to recover, and I'm still alive today because of his kindness and the air conditioning in his truck.

These personal experiences aren't isolated incidents—they're reflections of the same human impulse toward mutual aid that has sustained communities throughout history.

## Small Actions, Big Impacts

The idea of contributing positively to society is hardly new, as noted, but it's
good to occasionally take a moment to think about whether you _are_ contributing
positively. And instead of applying a lot of pressure on yourself to make net
positive contributions, it may be easier to reduce the amount of net negative
contribution. Small acts of kindness—holding a door, offering directions to someone lost, or simply smiling at a stranger—can create ripple effects far beyond what we might imagine.

<div id="ripple-visualization" class="visualization-container"></div>

Life is a series of choices we make every day, with some decisions bigger than
others, and most of the time our options are imperfect. No matter how
insignificant the choice, we can at least choose to be a little less negative.
Help your neighbour if you can, don't litter, and find something to work on that
doesn't make the world a worse place. In doing so, you might just find that contributing positively to society makes your own life more meaningful and satisfying too.

## Your Turn

This week, try one deliberate act of positive contribution to your community. It could be picking up litter in your local park, checking in on an elderly neighbor, contributing to an open-source project, or simply practicing patience with someone who frustrates you. Then notice how it affects not just them, but your own sense of connection and purpose. What small positive contribution could you make a regular habit?

The revolution begins not with grand gestures, but with these small acts of neighborliness that, together, can transform disconnection into community. As anthropologist Margaret Mead famously said, "Never doubt that a small group of thoughtful, committed citizens can change the world; indeed, it's the only thing that ever has."

## Further Reading

- _Bowling Alone: The Collapse and Revival of American Community_ by Robert D. Putnam – A seminal work on the decline of social capital in America and its implications.
- _Humankind: A Hopeful History_ by Rutger Bregman – An optimistic examination of human nature that challenges cynical views of society.
- _The Empathic Civilization_ by Jeremy Rifkin – Explores how empathy has shaped human development and could be key to our future survival.

[^1]: According to research from Brigham Young University published in PLOS Medicine, strong social relationships can improve odds of survival by 50%. [Link](https://journals.plos.org/plosmedicine/article?id=10.1371%2Fjournal.pmed.1000316)
[^2]: Based on the 2019 AEI Survey on Community and Society findings. Roughly 75% of Americans with a high school education or less report seldom or never attending local community events or meetings. [Link](https://www.aei.org/wp-content/uploads/2019/02/AEI-Survey-on-Community-and-Society-Social-Capital-Civic-Health-and-Quality-of-Life-in-the-United-States.pdf)
[^3]: Based on 2022 data reported by ZDNet, likely referencing W3Techs, which monitors web technology usage across the top million websites. [Link](https://www.zdnet.com/article/linux-has-over-3-of-the-desktop-market-its-more-complicated-than-that/)
[^5]: Doctorow, C. (2023, January 21). "Tiktok's Enshittification". Pluralistic blog. [Link](https://pluralistic.net/2023/01/21/potemkin-ai/)
[^6]: According to Statista's 2023 Global Mobile Operating System Market Share report. [Link](https://www.statista.com/statistics/272698/global-market-share-held-by-mobile-operating-systems-since-2009/)
[^7]: Google Economic Impact Report (2023) showing $739B US activity. [Link](https://economicimpact.google); Sensor Tower "State of Mobile 2024" report showing $0.5T global app economy in 2023. [Link](https://sensortower.com/blog/state-of-mobile-2024)
[^8]: Gaskell, A. (2024, August 21). "The $9 Trillion Value Of Open Source". Adigaskell.org. Citing Harvard/U. Toronto research estimating $8.8T demand-side value. [Link](https://adigaskell.org/2024/08/21/the-9-trillion-value-of-open-source/)

<style>
.visualization-container {
  width: 100%;
  height: 500px;
  margin: 30px 0;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  background-color: #f5f8fa;
}

.dark .visualization-container {
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  background-color: #1a1a1a;
}

.visualization-legend {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 15px;
  font-size: 14px;
}

.legend-item {
  display: flex;
  align-items: center;
  margin: 0 15px;
}

.legend-color {
  width: 12px;
  height: 12px;
  margin-right: 5px;
  border-radius: 50%;
}

/* Add a placeholder loading state */
.visualization-container::before {
  content: "Loading visualization...";
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
  font-style: italic;
  color: #555;
}

.dark .visualization-container::before {
  color: #aaa;
}

/* Hide placeholder when visualization is loaded */
.visualization-container.loaded::before {
  display: none;
}
</style>

<script src="https://d3js.org/d3.v6.min.js"></script>
<script>
// Wrap in an immediately invoked function expression to avoid polluting global scope
(function() {
  // Function to get color scheme based on theme
  function getColorScheme() {
    // Check specifically on documentElement (html tag) where the dark class is added
    const isDarkMode = document.documentElement.classList.contains('dark');
    console.log("Dark mode detected:", isDarkMode);

    return {
      background: isDarkMode ? '#1a1a1a' : '#f5f8fa',
      text: isDarkMode ? '#e1e1e1' : '#333333',
      primary: isDarkMode ? '#61dafb' : '#3498db',
      secondary: isDarkMode ? '#bb86fc' : '#9b59b6',
      tertiary: isDarkMode ? '#ff7597' : '#e74c3c',
      quaternary: isDarkMode ? '#62efff' : '#2ecc71',
      ripple: isDarkMode ? 'rgba(255,255,255,0.07)' : 'rgba(0,0,0,0.05)'
    };
  }

  // Store visualization state and references
  let visualizationState = {
    container: null,
    svg: null,
    simulation: null,
    colorScheme: null,
    initialized: false
  };
  
  // Function to initialize or update visualization
  function initVisualization(update = false) {
    console.log("Initializing visualization, update:", update);

    // Get the container element
    const container = document.getElementById('ripple-visualization');
    if (!container) {
      console.error("Visualization container not found");
      return;
    }

    visualizationState.container = container;

    // Ensure the container has dimensions
    if (container.clientWidth === 0) {
      console.log("Container has no width, setting default width");
      container.style.width = "100%";
    }

    // Get color scheme based on current theme
    const colorScheme = getColorScheme();
    visualizationState.colorScheme = colorScheme;

    // Data for our visualization
    const contributions = [
      {
        type: "Individual Acts",
        examples: [
          {name: "Help a neighbor", impact: 1, color: colorScheme.primary,
           effects: ["Improved wellbeing", "Strengthened connection"]},
          {name: "Volunteer time", impact: 2, color: colorScheme.primary,
           effects: ["Community support", "Personal growth"]},
          {name: "Share knowledge", impact: 1.5, color: colorScheme.primary,
           effects: ["Empowerment", "Advancement"]}
        ]
      },
      {
        type: "Community Efforts",
        examples: [
          {name: "Local organizing", impact: 3, color: colorScheme.secondary,
           effects: ["Social cohesion", "Problem solving", "Civic engagement"]},
          {name: "Neighborhood cleanup", impact: 2.5, color: colorScheme.secondary,
           effects: ["Environmental benefit", "Pride of place", "Collective efficacy"]}
        ]
      },
      {
        type: "Collective Projects",
        examples: [
          {name: "Open source", impact: 4, color: colorScheme.tertiary,
           effects: ["Innovation", "Accessibility", "Knowledge sharing", "Economic value"]},
          {name: "Mutual aid network", impact: 3.5, color: colorScheme.tertiary,
           effects: ["Resource distribution", "Crisis resilience", "Community bonds"]}
        ]
      },
      {
        type: "Systemic Change",
        examples: [
          {name: "Policy advocacy", impact: 5, color: colorScheme.quaternary,
           effects: ["Structural improvement", "Wide-scale impact", "Long-term change", "Precedent setting", "Cultural shift"]}
        ]
      }
    ];

    // Flatten the data for easier use
    const flatData = contributions.flatMap(category =>
      category.examples.map(example => ({
        ...example,
        category: category.type
      }))
    );

    try {
      // If updating, clean up the old visualization
      if (update && visualizationState.svg) {
        visualizationState.svg.remove();
        if (visualizationState.simulation) {
          visualizationState.simulation.stop();
        }
        container.innerHTML = "";
      } else if (!update) {
        // Initial setup
        container.innerHTML = "";
      }

      // Set up the SVG
      const margin = {top: 60, right: 30, bottom: 60, left: 30};
      const width = container.clientWidth;
      const height = 500;

      console.log("Creating SVG with dimensions:", width, height);

      const svg = d3.select(container)
        .append('svg')
        .attr('width', width)
        .attr('height', height)
        .style('background', colorScheme.background);

      visualizationState.svg = svg;

      // Create a group to hold our visualization
      const g = svg.append('g')
        .attr('transform', `translate(${width/2}, ${height/2})`);

      // Add title
      svg.append('text')
        .attr('x', width/2)
        .attr('y', margin.top/2)
        .attr('text-anchor', 'middle')
        .attr('font-size', '20px')
        .attr('font-weight', 'bold')
        .attr('fill', colorScheme.text)
        .text('The Ripple Effect of Positive Contributions');

      // Subtitle
      svg.append('text')
        .attr('x', width/2)
        .attr('y', margin.top/2 + 25)
        .attr('text-anchor', 'middle')
        .attr('font-size', '14px')
        .attr('fill', colorScheme.text)
        .attr('opacity', 0.8)
        .text('From individual acts to systemic change, positive contributions create expanding waves of impact');

      // Scale for the node sizes
      const radiusScale = d3.scaleSqrt()
        .domain([0, d3.max(flatData, d => d.impact) || 5])
        .range([30, 80]);

      // Create ripple waves
      const ripples = g.selectAll('.ripple-group')
        .data(flatData)
        .enter()
        .append('g')
        .attr('class', 'ripple-group');

      // Add multiple expanding ripples for each node
      ripples.each(function(d) {
        const rippleGroup = d3.select(this);
        const numRipples = 3;

        for (let i = 0; i < numRipples; i++) {
          rippleGroup.append('circle')
            .attr('class', 'ripple')
            .attr('r', radiusScale(d.impact))
            .style('fill', 'none')
            .style('stroke', d.color)
            .style('stroke-width', 1)
            .style('opacity', 0.3)
            .style('stroke-dasharray', '3,3')
            .call(animateRipple);
        }

        function animateRipple(circle) {
          circle.transition()
            .duration(2000 + Math.random() * 1000)
            .attr('r', radiusScale(d.impact) * (1.5 + Math.random()))
            .style('opacity', 0)
            .on('end', function() {
              d3.select(this)
                .attr('r', radiusScale(d.impact))
                .style('opacity', 0.3)
                .call(animateRipple);
            });
        }
      });

      // Initial positions - spread nodes out to avoid clumping
      flatData.forEach((d, i) => {
        // Calculate position in a grid layout to start with
        const cols = 3;
        const row = Math.floor(i / cols);
        const col = i % cols;

        // Add some random offset to make it organic
        d.x = (col - 1) * 150 + (Math.random() * 40 - 20);
        d.y = (row - 1) * 120 + (Math.random() * 40 - 20);
      });

      // Set up a force simulation
      const simulation = d3.forceSimulation(flatData)
        .force('charge', d3.forceManyBody().strength(-100))
        .force('collide', d3.forceCollide().radius(d => radiusScale(d.impact) + 5).iterations(2))
        .force('x', d3.forceX().strength(0.05))
        .force('y', d3.forceY().strength(0.05))
        .on('tick', ticked);

      visualizationState.simulation = simulation;

      // Create nodes for each contribution
      const nodes = g.selectAll('.node')
        .data(flatData)
        .enter()
        .append('g')
        .attr('class', 'node')
        .call(d3.drag()
          .on('start', dragstarted)
          .on('drag', dragged)
          .on('end', dragended))
        .on('mouseover', showEffects)
        .on('mouseout', hideEffects);

      // Add circles to nodes
      nodes.append('circle')
        .attr('r', d => radiusScale(d.impact) * 0.7)
        .style('fill', d => d.color)
        .style('fill-opacity', 0.7)
        .style('stroke', d => d3.color(d.color).darker(0.5))
        .style('stroke-width', 2);

      // Add labels to nodes
      nodes.append('text')
        .text(d => d.name)
        .attr('text-anchor', 'middle')
        .attr('dy', 0)
        .attr('font-size', d => Math.min(radiusScale(d.impact) * 0.25, 14))
        .attr('fill', colorScheme.text)
        .attr('pointer-events', 'none');

      // Add impact values
      nodes.append('text')
        .text(d => `Impact: ${d.impact}`)
        .attr('class', 'impact-label')
        .attr('text-anchor', 'middle')
        .attr('dy', 15)
        .attr('font-size', d => Math.min(radiusScale(d.impact) * 0.2, 12))
        .attr('fill', colorScheme.text)
        .attr('pointer-events', 'none');

      // Create a group for displaying the ripple effects
      const effectsGroup = svg.append('g')
        .attr('class', 'effects-group')
        .style('opacity', 0);

      // Background for effects
      effectsGroup.append('rect')
        .attr('width', width - margin.left - margin.right)
        .attr('height', 0)
        .attr('x', margin.left)
        .attr('y', height - margin.bottom)
        .attr('rx', 8)
        .attr('fill', colorScheme.background === '#1a1a1a' ? 'rgba(0,0,0,0.8)' : 'rgba(255,255,255,0.9)')
        .attr('stroke', colorScheme.background === '#1a1a1a' ? 'rgba(255,255,255,0.2)' : 'rgba(0,0,0,0.1)')
        .attr('stroke-width', 1);

      // Effects title
      const effectsTitle = effectsGroup.append('text')
        .attr('x', width/2)
        .attr('y', height - margin.bottom + 20)
        .attr('text-anchor', 'middle')
        .attr('font-weight', 'bold')
        .attr('font-size', '16px')
        .attr('fill', colorScheme.text);

      // Effects list
      const effectsList = effectsGroup.append('g')
        .attr('transform', `translate(${width/2}, ${height - margin.bottom + 45})`);

      // Function to show ripple effects
      function showEffects(event, d) {
        // Update node appearance
        d3.select(this).select('circle')
          .transition()
          .duration(300)
          .style('fill-opacity', 0.9)
          .attr('r', radiusScale(d.impact) * 0.75);

        // Update effects panel
        effectsTitle.text(`${d.name} (${d.category}): Ripple Effects`);

        // Clear previous effects
        effectsList.selectAll('*').remove();

        // Add new effects
        d.effects.forEach((effect, i) => {
          effectsList.append('circle')
            .attr('cx', -5)
            .attr('cy', i * 25)
            .attr('r', 4)
            .attr('fill', d.color);

          effectsList.append('text')
            .attr('x', 5)
            .attr('y', i * 25 + 5)
            .attr('text-anchor', 'start')
            .attr('font-size', '14px')
            .attr('fill', colorScheme.text)
            .text(effect);
        });

        // Calculate height based on number of effects
        const height = Math.max(100, d.effects.length * 25 + 60);

        // Show effects panel
        effectsGroup.select('rect')
          .transition()
          .duration(300)
          .attr('height', height)
          .attr('y', 500 - margin.bottom - height);

        effectsGroup.transition()
          .duration(300)
          .style('opacity', 1);

        effectsTitle.transition()
          .duration(300)
          .attr('y', 500 - margin.bottom - height + 25);

        effectsList.transition()
          .duration(300)
          .attr('transform', `translate(${width/2}, ${500 - margin.bottom - height + 55})`);
      }

      // Function to hide ripple effects
      function hideEffects(event, d) {
        // Restore node appearance
        d3.select(this).select('circle')
          .transition()
          .duration(300)
          .style('fill-opacity', 0.7)
          .attr('r', radiusScale(d.impact) * 0.7);

        // Hide effects panel
        effectsGroup.transition()
          .duration(300)
          .style('opacity', 0);
      }

      // Create legend for categories
      const legendData = contributions.map(c => ({
        type: c.type,
        color: c.examples[0].color
      }));

      const legendContainer = d3.select(container)
        .append('div')
        .attr('class', 'visualization-legend');

      legendContainer.selectAll('.legend-item')
        .data(legendData)
        .enter()
        .append('div')
        .attr('class', 'legend-item')
        .html(d => `
          <div class="legend-color" style="background-color: ${d.color}"></div>
          <div>${d.type}</div>
        `);

      // Helper functions for force simulation and dragging
      function ticked() {
        nodes.attr('transform', d => `translate(${d.x}, ${d.y})`);
        ripples.attr('transform', d => `translate(${d.x}, ${d.y})`);
      }

      function dragstarted(event, d) {
        if (!event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
      }

      function dragged(event, d) {
        d.fx = event.x;
        d.fy = event.y;
      }

      function dragended(event, d) {
        if (!event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
      }

      // Add instructions
      svg.append('text')
        .attr('x', width/2)
        .attr('y', height - 20)
        .attr('text-anchor', 'middle')
        .attr('font-size', '14px')
        .attr('fill', colorScheme.text)
        .attr('opacity', 0.7)
        .text('Hover over circles to see effects • Drag to explore • Size indicates impact scale');

      // Mark as loaded to remove loading placeholder
      container.classList.add('loaded');
      visualizationState.initialized = true;

      console.log("Visualization successfully initialized");
    } catch (error) {
      console.error("Error in visualization:", error);
      // Show error message in container
      container.innerHTML = `<div style="padding: 20px; color: red;">Error loading visualization: ${error.message}</div>`;
    }
  }

  // Listen for appearance changes by observing the classList of html element
  // This works with the site's appearance switcher in appearance.js
  function setupAppearanceListener() {
    // Create a MutationObserver to watch for class changes on the HTML element
    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        if (mutation.attributeName === 'class') {
          console.log("Dark mode state changed, updating visualization");
          if (visualizationState.initialized) {
            // Recreate the visualization with new colors
            initVisualization(true);
          }
        }
      });
    });

    // Start observing the document element for class changes
    observer.observe(document.documentElement, { attributes: true });
    console.log("Appearance change listener set up");
  }

  // Attempt to initialize on DOMContentLoaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      initVisualization();
      setupAppearanceListener();
    });
  } else {
    // DOM already loaded, run immediately
    initVisualization();
    setupAppearanceListener();
  }
  
  // Fallback initialization after a delay if it still hasn't worked
  setTimeout(function() {
    const container = document.getElementById('ripple-visualization');
    if (container && !container.classList.contains('loaded')) {
      console.log("Fallback initialization");
      initVisualization();
      setupAppearanceListener();
    }
  }, 1000);
})();
</script>
